# 注释规范（Markdown 版本）

本规范用于嵌入式、后端、前端等通用工程，重点强调简洁、统一、可移植，无垃圾注释、不过度注释。

---

## 1. 注释总原则

1. **注释只解释“为什么”，不解释代码本身做了什么。**
2. **注释必须准确、简洁、必要。**
3. **注释语言必须统一（推荐：英文或中文二选一）。**
4. **注释必须与代码紧密贴合，不得脱节。**
5. **修改代码时需同步更新注释，避免过期信息。**

---

## 2. 文件头注释（可选，但推荐）

用于说明模块用途、作者、版本、变更记录等。

```c
/*
 * File: touch_driver.c
 * Description: XPT2046 driver for resistive touch panel.
 * Author: xxx
 * Version: 1.0
 * Date: 2025-12-09
 */
```

---

## 3. 函数注释（Doxygen / Javadoc 格式）

适用于公共 API、算法函数、驱动、接口模块。

```c
/**
 * @brief   Calculate delay using FFT-based correlation.
 * @param   real    Input real array.
 * @param   len     Length of the array.
 * @return  float   Delay in samples.
 */
```

---

## 4. 行内注释

只用于必要信息，简洁明了，不超过一行。

```c
timeout_ms = 500; // Prevent blocking under unstable connection
```

避免写无意义注释，如：

```c
// Increase i by one
i++; // 禁止
```

---

## 5. 逻辑块注释（段落注释）

适用于无法通过代码直接看懂的流程或关键逻辑。

```c
/*
 * The buffer size is increased to support simultaneous image
 * transmission and remote serial forwarding.
 */
```

---

## 6. Magic Number 注释

所有特殊含义的数字必须解释。

```c
if (data[i] == 1) { // 1 = black line
```

---

## 7. TODO / FIXME / NOTE

统一格式：

```c
// TODO: Add OPUS codec support
// FIXME: Race condition occurs when network is unstable
// NOTE: Firmware v1.2 does not support this API
```

---

## 8. 不需要写的注释（禁止）

* 翻译代码行为
* 每行都写注释
* 注释解释明显逻辑
* 注释解释变量类型
* 注释重复函数名

禁止示例：

```c
int speed = 10; // speed variable
```

---

## 9. 注释风格（统一要求）

### 单行注释风格

```
// Comment text
```

### 多行注释风格

```
/*
 * Comment text
 */
```

### 文档注释风格（推荐）

```
/** ... */
```

---

## 10. 推荐实践

1. 不写注释胜过写错误注释。
2. 复杂算法使用流程注释，不要逐行注释。
3. 模块、驱动、协议解析等应补充简短设计说明。
4. 统一语言（本项目中应始终一致）。

---

如需，我可以继续输出：

* **嵌入式项目注释示例（ESP-IDF / ARM CMSIS / FreeRTOS）**
* **前端/后端注释规范版本**
* **适用于大型项目的完整 Coding Style 文档**
